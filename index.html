<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Sheet Live Data</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  h2 { text-align: center; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }
  th, td {
    border: 1px solid #444;
    padding: 10px;
    text-align: center;
  }
  th {
    background: #0073e6;
    color: #fff;
  }
</style>
</head>
<body>

<h2>Live IoT Dashboard Data</h2>
<table id="dataTable"></table>

<script>
const sheetID = "1xfkdl2oWvB-HSpLBRwjj31YBCb-YDTUhjTJhVnW2o_g"; 
const sheetName = "Sheet1"; // Change if your tab name is different
const apiURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

fetch(apiURL)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substr(47).slice(0, -2));
    const table = document.getElementById("dataTable");

    let tableHTML = "<tr>";
    json.table.cols.forEach(col => {
      tableHTML += `<th>${col.label}</th>`;
    });
    tableHTML += "</tr>";

    json.table.rows.forEach(row => {
      tableHTML += "<tr>";
      row.c.forEach(cell => {
        tableHTML += `<td>${cell ? cell.v : ""}</td>`;
      });
      tableHTML += "</tr>";
    });

    table.innerHTML = tableHTML;
  })
  .catch(err => {
    console.error("Error loading Google Sheet data:", err);
  });
</script>

</body>
</html>
